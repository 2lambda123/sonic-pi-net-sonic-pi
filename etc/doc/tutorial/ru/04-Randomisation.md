4 Randomisation

# Рандомизация

Отличный способ сделать твою музыку несколько более интересной - это использовать
случайные числа. В Sonic Pi есть замечательная функция добавления случайности в
музыку, но прежде, чем мы начнем, нужно усвоить неприятную истину: в Sonic Pi
*случайности не являются по-настоящему случайными*. Что же, спрашивается, это
значит? Давай разберемся.

## Повторяемость

Очень полезная случайная функция называется `rrand`. Она вернет случайное значение
в диапазоне двух чисел - *минимума* и *максимума* (`rrand` - сокращение от
ранжированный случайный генератор). Попробуем проиграть какую-нибудь случайную
ноту:

```
play rrand(50, 95)
```

Ого, получился неожиданный звук. Он воспроизвел ноту `83.7527`. Прекрасная
случайная нота в промежутке между 50 и 95. Постой-ка, я только что точно предсказал
случайную ноту, которая и у тебя получилась? Что-то тут нечисто. Попробуй снова.
Что? Он снова выбрал `83.7527`? Это явно не случайно!

Правда в том, что выбор не случаен по-настоящему, он псевдо-случаен. Sonic Pi
выдает повторяющиеся псевдо-случайные числа. Чтобы быть уверенным, что музыка,
которую ты создаешь на своей машине, будет совпадать с той, что получается на всех
остальных, это очень полезное свойство. Даже если ты добавляешь немного случайности
в свои композиции.

Конечно же, в кокретном музыкальном произведении, если бы `83.7527` 'случайно'
выбиралась каждый раз, то было бы не очень интересно. Но все-таки этого не происходит
Попробуй следующее:

```
loop do
  play rrand(50, 95)
  sleep 0.5
end
```

Ура! Наконец-то он звучит случайно. В течение одного запуска последующие вызовы
функции случайного генератора будут возвращать случайные значения. Однако,
следующий прогон создаст точно такую же последовательность случайных чисел и
будет звучать идентично. Как если бы код Sonic Pi возвращался бы назад во времени
в точку всякий раз, когда нажимается кнопка Run. Это День Сурка для музыкального
синтеза!

## Колокола с привидениями

Прекрасной иллюстрацией рандомизации в действии является пример колоколов, в
которые как будто вселились призраки. Он повторяет `:perc_bell` сэмпл, выбирая
случайную скорость и задержку между звуками:

```
loop do
  sample :perc_bell, rate: (rrand 0.125, 1.5)
  sleep rrand(0.2, 2)
end
```

## Случайный срез

Еще один забавный пример случайности - управление частотой среза синта случайным
образом. Отличный синт, на котором можно это попробовать, - это эмулятор `:tb303`:

```
use_synth :tb303

loop do
  play 50, release: 0.1, cutoff: rrand(60, 120)
  sleep 0.125
end
```

## Затравки случайных чисел

Что, если тебе не нравится именно эта последовательность случайных чисел,
сгенерированная Sonic Pi? Ну, очень легко выбрать другую начальную точку, если
использовать `use_random_seed`. Затравка по умолчанию равна 0, так что для другого
случайного результата выбирай другую затравку!

Сравни следующее:

```
5.times do
  play rrand(50, 100)
  sleep 0.5
end
```

Каждый раз, когда этот код выполняется, ты будешь слышать один и тот же набор
нот. Чтобы получить другой порядок просто поменяй затравку:

```
use_random_seed 40
5.times do
  play rrand(50, 100)
  sleep 0.5
end
```

В итоге получится другая последовательность из 5 нот. Изменяя затравку и слушая
результат, ты можешь выбрать что-то, что тебе нравится. Потом, когда ты делишься
с другими, то они услышат в точности то же самое, что и ты.

Давай познакомимся с некоторыми другими случайными функциями.

## choose

Очень часто приходится выбирать вещь случайным образом из списка данных. Например,
мне бы могло захотеться проиграть одну ноту из набора: 60, 65 и 72. Я могу достичь
этого с помощью `choose`, которая позволяет мне выбрать предмет из списка. Вначале,
надо добавить мои числа в список, что достигается заключением их в квадратные скобки
и разделением из запятыми: `[60, 65, 72]`. Затем, надо просто передать их `choose`:

```
choose([60, 65, 72])
```

Послушаем, на что это похоже:

```
loop do
  play choose([60, 65, 72])
  sleep 1
end
```

## rrand

Мы уже видели `rrand`, но пробежимся по ней вновь. Она возвращает случайную
величину в промежутке двух чисел, не включая границы. Это значит, что никогда
не будет выбрано самое большое или самое маленькое значение - всегда нечто между
ними. Число всегда будет дробным, то есть не целым. Примеры дробных чисел,
возвращаемых `rrand(20, 110)`:

* 87.5054931640625
* 86.05255126953125
* 61.77825927734375

## rrand_i

Время от времени тебе понадобится целое случайное число, а не дробное. Тут-то и
придет на помощь `rrand_i`. Она работает так же, как `rrand`, но она включает
граничные значения (то есть она может выбирать минимальные и максимальные числа).
Примеры, полученные из `rrand_i(20, 110)`:

* 88
* 86
* 62

## rand

Вернет случайное дробное число от 0 (включительно) до максимального указанного
тобой. По умолчанию числа лежат в промежутке от 0 до 1. Такая функция полезна для
выбора случайного усиления:

```
loop do
  play 60, amp: rand
  sleep 0.25
end
```

## rand_i

Относится к `rrand_i`, как `rrand_i` к `rrand`. То есть она выбирает случайное
целое число в диапазоне от 0 до максимального значение, которое ты укажешь.

## dice

Иногда нужно изобразить бросание игральных костей - это частный случай `rrand_i`,
когда минимальное значение всегда 1. В вызов `dice` требуется передать количество
сторон кости. Стандартная игральная кость имеет 6 сторон, так что `dice(6)` будет
работать очень похожим образом - возвращать 1, 2, 3, 4, 5 или 6. Однако, прямо как
в ролевых играх в стиле фэнтези, пользу может принести и кость с 4 сторонами, и
с 12 сторонами или с 20 сторонами. Может даже потребуется кость со 120 гранями!

## one_in

Наконец, может потребоваться подражать бросанию костей на высшее значение, например
6 для обычной кости. Функция `one_in` возвращает истинное значение с вероятностью
один из числа сторон кости. Следовательно, для `one_in(6)` шанс получить истину
составляет 1 к 5. В остальных 5 из 6 случаях вернется ложь. Истинные и ложные
значения очень полезны для логических выражений `if`, которые мы рассмотрим в одной
из следующих глав нашего учебника.

Теперь пришла пора добавить немного неразберихи в твою музыку за счет случайности!
